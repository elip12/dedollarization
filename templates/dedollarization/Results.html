{% extends "global/Page.html" %}
{% load otree %}
{% load staticfiles otree %}

{% block styles %}
<style>
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
th, td {
  padding: 15px;
}
</style>
{% endblock %}

{% block title %}
    Results: Round {{ subsession.round_number }}
{% endblock %}

{% block content %}
    <p>
        This round, you were a {{ role_pre }}.
        <br>
        {% if token_color != Constants.trade_good %}
        You had a {{ token_color }} token.
        <br>
        {% endif %}
        You were randomly paired with a {{ other_role_pre }}.
        <br>
        {% if trade_attempted %}
        You attempted to trade.
        <br>
        {% else %}
        You did or could not attempt to trade.
        {% endif %}
        {% if trade_succeeded %}
        You successfully traded. You now have a
        {% if new_token_color != Constants.trade_good %}
        {{ new_token_color }} token.
        <br>
        {% if new_token_color == Constants.red %}
        <img src="{% static "redCoin.png"%}"/>
        {% endif %}
        {% if new_token_color == Constants.blue %}
        <img src="{% static "blueCoin.png"%}"/>
        {% endif %}
        {% else %}
        trade good.
        <br>
        <img src="{% static "object.png"%}"/>
        {% endif %}
        <br>
        {% endif %}
        You earned {{ round_payoff|c }} points this round.
        <br>
        Your total payoff so far is {{ player.participant.payoff|c }}.   
    </p>

{% if subsession.round_number > 1 %}
<p>Your Previous Trades</p>
<table class = "t2">
    <tr class = "t2">
        <th class = "t2">Round</th>
        <th class = "t2">Your Item</th>
        <th class = "t2">Partner's Item</th>
        <th class = "t2">Partner's Group</th>
        <th class = "t2">Trade Possible</th>
        <th class = "t2">Trade Attempted</th>
        <th class = "t2">Trade Succeeded</th>
        <th class = "t2">Round Payoff</th>
        {% if session.config.show_foreign_transactions %}
        <th class = "t2">Foreign Transactions</th>
        {% endif %}
    </tr>
    {% for p in player.in_previous_rounds reversed %}
    <tr class = "t2">
        <td class = "t2">{{ p.round_number }}</td>
        <td class = "t2">{{ p.token_color }}</td>
        <td class = "t2">{{ p.other_token_color }}</td>
        <td class = "t2">{{ p.other_group_color}}</td>
        {% if role_pre == other_role_pre %}
        <td class = "t2">No</td>
        {% else %}
        <td class = "t2">Yes</td>
        {% endif %}
        {% if p.trade_attempted == True %}
        <td class = "t2">Yes</td>
        {% else %}
        <td class = "t2">No</td>
        {% endif %}
        {% if p.trade_succeeded == True %}
        <td class = "t2">Yes</td>
        {% else %}
        <td class = "t2">No</td>
        {% endif %}
        <td class = "t2">{{ p.payoff }}</td>
        {% if session.config.show_foreign_transactions %}
        <td class = "t2">{{ p.subsession.fc_transactions }}</td>
        {% endif %}
    </tr>
    {% endfor %}
                      
</table>
{% endif %}
<br>
    {% next_button %}
{% endblock %}
